<?php//  ------------------------------------------------------------------------ ////                               phpWordTrain                                ////                           Copyright (c) 2005                              ////                     <http://phpwordtrain.berlios.de>                      ////  ------------------------------------------------------------------------ ////  This program is free software; you can redistribute it and/or modify     ////  it under the terms of the GNU General Public License as published by     ////  the Free Software Foundation; either version 2 of the License, or        ////  (at your option) any later version.                                      ////                                                                           ////  You may not change or alter any portion of this comment or credits       ////  of supporting developers from this source code or any supporting         ////  source code which is considered copyrighted (c) material of the          ////  original comment or credit authors.                                      ////                                                                           ////  This program is distributed in the hope that it will be useful,          ////  but WITHOUT ANY WARRANTY; without even the implied warranty of           ////  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the            ////  GNU General Public License for more details.                             ////                                                                           ////  You should have received a copy of the GNU General Public License        ////  along with this program; if not, write to the Free Software              ////  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA ////  ------------------------------------------------------------------------ ////                                                                           ////  File:         /study/learn.php                                           ////  Language:     PHP 4.3                                                    ////                                                                           ////  Description:  Asks user marked words as ready for questioning            ////                                                                           ////  Author:       Francisco Garcia Rodriguez <kalahan@users.berlios.de>      ////                                                                           ////  $Id$//  ------------------------------------------------------------------------ //session_start();include "../common.php";include "../lib/format.php";include "inc/learn.inc";$smarty= Template();$smarty->assign("section", "Study");$today_hits= ( isset($_COOKIE[date("Ymd")]) )?    $_COOKIE[date("Ymd")] :    0;$day_last= time()+43200;                    // OK, not till 00:00, but 12hif (!isset($_COOKIE["asked_".date("Ymd")])){    setcookie("asked_".date("Ymd"), 1, $day_last);}else{    setcookie("asked_".date("Ymd"), $_COOKIE["asked_".date("Ymd")]+1,$day_last);}// Translation to local vars$question = &$_SESSION['question'];$count    = $_POST['counter'];// Checks if all marked words are askedif ( isset($count) && ($count == 0) )    $smarty->assign("asking",false);else    $smarty->assign("asking",true);// Checks on last asked wordif ( $_POST['action'] == "Check") {    $answer= trim($_POST['answer']);    $word= $question[$count]['word'];    $smarty->assign("last_trans",    $question[$count]['translation']);    $smarty->assign("last_word",     $question[$count]['word']);    $smarty->assign("last_word_tip", $question[$count]['tip_trans']);    $smarty->assign("last_answer",   $answer);    $smarty->assign("checking",true);    if ( $question[$count]['word'] == $answer )     // Right answer    {        $smarty->assign("answer", true);        $today= date('YmdHis');        $sql= "update lang_german set datein=datein, lasthit=$today,".              "level=level+1, hot=0 where word='$answer'";                      if (!isset($_COOKIE[date("Ymd")]))            setcookie(date("Ymd"), 1, $day_last);        else        {            setcookie(date("Ymd"), $_COOKIE[date("Ymd")]+1,$day_last);            $today_hits++;        }            }    else                                            // Wrong answer    {        $smarty->assign("answer", false);        $trans= $question[$count]['translation'];          $sql= "update lang_german set misses=misses+1,level=0,lasthit=lasthit,               datein=datein where word='$word'";    }    mysql_query($sql) or die(mysql_error());}else{    $_SESSION['question']= null;    $question = null;    $count= BuildQuestions($_SESSION['question']);    $question = $_SESSION['question'];}// Now we must ask the word$count--;$smarty->assign("translation", $question[$count]['translation']);$smarty->assign("tip_word", $question[$count]['tip_word']);$smarty->assign("tip_trans", $question[$count]['tip_trans']);$smarty->assign("today_asked", $_COOKIE["asked_".date("Ymd")]);$smarty->assign("today", $today_hits);$smarty->assign("counter", $count);$smarty->display('study/learn.tpl');?>